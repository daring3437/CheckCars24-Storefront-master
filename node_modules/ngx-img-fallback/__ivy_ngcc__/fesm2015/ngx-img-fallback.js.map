{"version":3,"file":"ngx-img-fallback.js","sources":["ng:/ngx-img-fallback/src/app/modules/ngx-img-fallback/ngx-img-fallback.directive.ts","ng:/ngx-img-fallback/src/app/modules/ngx-img-fallback/ngx-img-fallback.module.ts","ng:/ngx-img-fallback/src/app/modules/ngx-img-fallback/index.ts","ng:/ngx-img-fallback/public_api.ts","ng:/ngx-img-fallback/ngx-img-fallback.ts"],"names":["tslib_1.__decorate"],"mappings":"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","sourcesContent":["/**\n * Created by vadimdez on 28/01/2018.\n */\nimport { Directive, ElementRef, Input, Output, EventEmitter, OnDestroy, Renderer2 } from '@angular/core';\n\n@Directive({\n  selector: '[src-fallback]'\n})\nexport class ImgFallbackDirective implements OnDestroy {\n\n  @Input('src-fallback') imgSrc: string;\n  @Output('loaded') loaded = new EventEmitter<boolean>();\n  private nativeElement: HTMLElement;\n  private isApplied: boolean = false;\n  private ERROR_EVENT_TYPE: string = 'error';\n  private LOAD_EVENT_TYPE: string = 'load';\n  private cancelOnError: Function;\n  private cancelOnLoad: Function;\n\n  constructor(private el: ElementRef, private renderer: Renderer2) {\n    this.nativeElement = el.nativeElement;\n\n    this.onError = this.onError.bind(this);\n    this.onLoad = this.onLoad.bind(this);\n    this.addEvents();\n  }\n\n  ngOnDestroy() {\n    this.removeErrorEvent();\n    this.removeOnLoadEvent();\n  }\n\n  private onError() {\n    if (this.nativeElement.getAttribute('src') !== this.imgSrc) {\n      this.isApplied = true;\n      this.renderer.setAttribute(this.nativeElement, 'src', this.imgSrc);\n    } else {\n      this.removeOnLoadEvent();\n    }\n  }\n\n  private onLoad() {\n    this.loaded.emit(this.isApplied);\n  }\n\n  private removeErrorEvent() {\n    if (this.cancelOnError) {\n      this.cancelOnError();\n    }\n  }\n\n  private removeOnLoadEvent() {\n    if (this.cancelOnLoad) {\n      this.cancelOnLoad();\n    }\n  }\n\n  private addEvents() {\n    this.cancelOnError = this.renderer.listen(this.nativeElement, this.ERROR_EVENT_TYPE, this.onError);\n    this.cancelOnLoad = this.renderer.listen(this.nativeElement, this.LOAD_EVENT_TYPE, this.onLoad);\n  }\n}\n","/**\n * Created by vadimdez on 27/11/2016.\n */\nimport { NgModule } from '@angular/core';\n\nimport { ImgFallbackDirective } from './ngx-img-fallback.directive';\n\n@NgModule({\n  declarations: [ImgFallbackDirective],\n  exports: [ImgFallbackDirective]\n})\nexport class ImgFallbackModule { }\n","/**\n * Created by Vadym Yatsyuk on 28.01.18\n */\n\nexport * from './ngx-img-fallback.module';\nexport * from './ngx-img-fallback.directive';","/**\n * Created by Vadym Yatsyuk on 28.01.18\n */\nexport * from './src/app/modules/ngx-img-fallback/index';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}